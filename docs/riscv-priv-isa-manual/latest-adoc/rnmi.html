<html>
<head>
<link rel="stylesheet" href="../../assets/docs.css">
<title>The RISC-V Instruction Set Manual, Volume II: Privileged Architecture</title>
</head>
<body>

<table>
<tr><th colspan=2>Metadata Table</th></tr>
<tr><th>Manual Type</th><td> priv</td></tr>
<tr><th>Spec Revision</th><td> </td></tr>
<tr><th>Spec Release Date</th><td> </td></tr>
<tr><th>Git Revision</th><td> riscv-isa-release-1239329-2023-05-23-96-g1ee25e1</td></tr>
<tr><th>Git URL</th><td><a href=https://github.com/riscv/riscv-isa-manual.git>https://github.com/riscv/riscv-isa-manual.git</a></td></tr>
<tr><th>Source</th><td>src/rnmi.adoc</td></tr>
<tr><th>Conversion Date</th><td>2023/11/12</td></tr>
<tr><th>License</th><td><a href=https://creativecommons.org/licenses/by/4.0/>CC-by-4.0</a></td></tr>
</table>

<div class="sect1">
<h2 id="rnmi">1. "Smrnmi" Standard Extension for Resumable Non-Maskable Interrupts, Version 0.4</h2>
<div class="sectionbody">
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Warning! This draft specification may change before being accepted as
standard by RISC-V International.</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The base machine-level architecture supports only unresumable
non-maskable interrupts (UNMIs), where the NMI jumps to a handler in
machine mode, overwriting the current <code>mepc</code> and <code>mcause</code> register
values. If the hart had been executing machine-mode code in a trap
handler, the previous values in <code>mepc</code> and <code>mcause</code> would not be
recoverable and so execution is not generally resumable.</p>
</div>
<div class="paragraph">
<p>The Smrnmi extension adds support for resumable non-maskable interrupts
(RNMIs) to RISC-V. The extension adds four new CSRs (<code>mnepc</code>, <code>mncause</code>,
<code>mnstatus</code>, and <code>mnscratch</code>) to hold the interrupted state, and one new
instruction, MNRET, to resume from the RNMI handler.</p>
</div>
<div class="sect2">
<h3 id="_rnmi_interrupt_signals">1.1. RNMI Interrupt Signals</h3>
<div class="paragraph">
<p>The <code>rnmi</code> interrupt signals are inputs to the hart. These interrupts
have higher priority than any other interrupt or exception on the hart
and cannot be disabled by software. Specifically, they are not disabled
by clearing the <code>mstatus</code>.MIE register.</p>
</div>
</div>
<div class="sect2">
<h3 id="_rnmi_handler_addresses">1.2. RNMI Handler Addresses</h3>
<div class="paragraph">
<p>The RNMI interrupt trap handler address is implementation-defined.</p>
</div>
<div class="paragraph">
<p>RNMI also has an associated exception trap handler address, which is
implementation defined.</p>
</div>
</div>
<div class="sect2">
<h3 id="_rnmi_csrs">1.3. RNMI CSRs</h3>
<div class="paragraph">
<p>This proposal adds additional M-mode CSRs to enable a resumable
non-maskable interrupt (RNMI).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz48c3ZnIGhlaWdodD0nMTA2JyBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSd4TWlkWU1pZCBtZWV0JyB4bWxuczpzdmc9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2ZXJzaW9uPScxLjAnIHZpZXdCb3g9JzAgMCAxMzQwIDEwNicgd2lkdGg9JzEzNDAnIHhtbG5zOnhsaW5rPSdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc1MCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nOTAnIHk9JzEzJz5NWExFTi0xPC90ZXh0Pjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PScxMzAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzE3MCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nMjEwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PScyNTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzI5MCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nMzMwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSczNzAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzQxMCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nNDUwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc0OTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzUzMCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nNTcwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc2MTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzY1MCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nNjkwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc3MzAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9Jzc3MCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nODEwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc4NTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9Jzg5MCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nOTMwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc5NzAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzEwMTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzEwNTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzEwOTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzExMzAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzExNzAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzEyMTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzEyNTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzEyOTAnIHk9JzEzJz4wPC90ZXh0PjxsaW5lIHN0cm9rZT0nIzAwMDAwMCcgc3Ryb2tlLXdpZHRoPScxJyB4MT0nMzAnIHgyPScxMzEwJyB5MT0nMjUnIHkyPScyNScvPjxsaW5lIHN0cm9rZT0nIzAwMDAwMCcgc3Ryb2tlLXdpZHRoPScxJyB4MT0nMzAnIHgyPScxMzEwJyB5MT0nNjUnIHkyPSc2NScvPjxsaW5lIHN0cm9rZT0nIzAwMDAwMCcgc3Ryb2tlLXdpZHRoPScxJyB4MT0nMTMxMCcgeDI9JzEzMTAnIHkxPScyNScgeTI9JzY1Jy8+PGxpbmUgc3Ryb2tlPScjMDAwMDAwJyBzdHJva2Utd2lkdGg9JzEnIHgxPSczMCcgeDI9JzMwJyB5MT0nMjUnIHkyPSc2NScvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzY3MCcgeT0nNDYnPm1uc2NyYXRjaDwvdGV4dD48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nTSsgMXAgRmFsbGJhY2snIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzY3MCcgeT0nODYnPk1YTEVOPC90ZXh0Pjwvc3ZnPg==" alt="Diagram" width="1340" height="106">
</div>
<div class="title">Figure 1. Resumable NMI scratch register <code>mnscratch</code></div>
</div>
<div class="paragraph">
<p>The <code>mnscratch</code> CSR holds an MXLEN-bit read-write register which enables
the NMI trap handler to save and restore the context that was
interrupted.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz48c3ZnIGhlaWdodD0nMTA2JyBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSd4TWlkWU1pZCBtZWV0JyB4bWxuczpzdmc9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2ZXJzaW9uPScxLjAnIHZpZXdCb3g9JzAgMCAxMzQwIDEwNicgd2lkdGg9JzEzNDAnIHhtbG5zOnhsaW5rPSdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc1MCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nOTAnIHk9JzEzJz5NWExFTi0xPC90ZXh0Pjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PScxMzAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzE3MCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nMjEwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PScyNTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzI5MCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nMzMwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSczNzAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzQxMCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nNDUwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc0OTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzUzMCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nNTcwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc2MTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzY1MCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nNjkwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc3MzAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9Jzc3MCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nODEwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc4NTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9Jzg5MCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nOTMwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc5NzAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzEwMTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzEwNTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzEwOTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzExMzAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzExNzAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzEyMTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzEyNTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzEyOTAnIHk9JzEzJz4wPC90ZXh0PjxsaW5lIHN0cm9rZT0nIzAwMDAwMCcgc3Ryb2tlLXdpZHRoPScxJyB4MT0nMzAnIHgyPSc2NzAnIHkxPScyNScgeTI9JzI1Jy8+PGxpbmUgc3Ryb2tlPScjMDAwMDAwJyBzdHJva2Utd2lkdGg9JzEnIHgxPSczMCcgeDI9JzY3MCcgeTE9JzY1JyB5Mj0nNjUnLz48bGluZSBzdHJva2U9JyMwMDAwMDAnIHN0cm9rZS13aWR0aD0nMScgeDE9JzMwJyB4Mj0nMzAnIHkxPScyNScgeTI9JzY1Jy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J2VuZCcgeD0nNjY2JyB5PSc0Nic+bW5lcGMgPC90ZXh0PjxsaW5lIHN0cm9rZT0nIzAwMDAwMCcgc3Ryb2tlLXdpZHRoPScxJyB4MT0nNjcwJyB4Mj0nMTMxMCcgeTE9JzI1JyB5Mj0nMjUnLz48bGluZSBzdHJva2U9JyMwMDAwMDAnIHN0cm9rZS13aWR0aD0nMScgeDE9JzY3MCcgeDI9JzEzMTAnIHkxPSc2NScgeTI9JzY1Jy8+PGxpbmUgc3Ryb2tlPScjMDAwMDAwJyBzdHJva2Utd2lkdGg9JzEnIHgxPScxMzEwJyB4Mj0nMTMxMCcgeTE9JzI1JyB5Mj0nNjUnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LXNpemU9JzI0JyBmb250LXdlaWdodD0nYm9sZCcgdGV4dC1hbmNob3I9J3N0YXJ0JyB4PSc2NzQnIHk9JzQ2Jz4oV0FSTCk8L3RleHQ+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J00rIDFwIEZhbGxiYWNrJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc2NzAnIHk9Jzg2Jz5NWExFTjwvdGV4dD48L3N2Zz4=" alt="Diagram" width="1340" height="106">
</div>
<div class="title">Figure 2. Resumable NMI program counter <code>mnepc</code>.</div>
</div>
<div class="paragraph">
<p>The <code>mnepc</code> CSR is an MXLEN-bit read-write register which on entry to
the NMI trap handler holds the PC of the instruction that took the
interrupt.</p>
</div>
<div class="paragraph">
<p>The low bit of <code>mnepc</code> (<code>mnepc[0]</code>) is always zero. On implementations
that support only IALIGN=32, the two low bits (<code>mnepc[1:0]</code>) are always
zero.</p>
</div>
<div class="paragraph">
<p>If an implementation allows IALIGN to be either 16 or 32 (by changing
CSR <code>misa</code>, for example), then, whenever IALIGN=32, bit <code>mnepc[1]</code> is
masked on reads so that it appears to be 0. This masking occurs also for
the implicit read by the MRET instruction. Though masked, <code>mnepc[1]</code>
remains writable when IALIGN=32.</p>
</div>
<div class="paragraph">
<p><code>mnepc</code> is a <strong>WARL</strong> register that must be able to hold all valid virtual
addresses. It need not be capable of holding all possible invalid
addresses. Prior to writing <code>mnepc</code>, implementations may convert an
invalid address into some other invalid address that <code>mnepc</code> is capable
of holding.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz48c3ZnIGhlaWdodD0nMTA2JyBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSd4TWlkWU1pZCBtZWV0JyB4bWxuczpzdmc9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2ZXJzaW9uPScxLjAnIHZpZXdCb3g9JzAgMCAxMzQwIDEwNicgd2lkdGg9JzEzNDAnIHhtbG5zOnhsaW5rPSdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc1MCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nOTAnIHk9JzEzJz5NWExFTi0xPC90ZXh0Pjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PScxMzAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzE3MCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nMjEwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PScyNTAnIHk9JzEzJz5NWExFTi0yPC90ZXh0Pjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PScyOTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzMzMCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nMzcwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc0MTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzQ1MCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nNDkwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc1MzAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzU3MCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nNjEwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc2NTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzY5MCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nNzMwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc3NzAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzgxMCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nODUwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc4OTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzkzMCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nOTcwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PScxMDEwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PScxMDUwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PScxMDkwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PScxMTMwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PScxMTcwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PScxMjEwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PScxMjUwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PScxMjkwJyB5PScxMyc+MDwvdGV4dD48bGluZSBzdHJva2U9JyMwMDAwMDAnIHN0cm9rZS13aWR0aD0nMScgeDE9JzMwJyB4Mj0nMTkwJyB5MT0nMjUnIHkyPScyNScvPjxsaW5lIHN0cm9rZT0nIzAwMDAwMCcgc3Ryb2tlLXdpZHRoPScxJyB4MT0nMzAnIHgyPScxOTAnIHkxPSc2NScgeTI9JzY1Jy8+PGxpbmUgc3Ryb2tlPScjMDAwMDAwJyBzdHJva2Utd2lkdGg9JzEnIHgxPScxOTAnIHgyPScxOTAnIHkxPScyNScgeTI9JzY1Jy8+PGxpbmUgc3Ryb2tlPScjMDAwMDAwJyBzdHJva2Utd2lkdGg9JzEnIHgxPSczMCcgeDI9JzMwJyB5MT0nMjUnIHkyPSc2NScvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdNKyAxcCBGYWxsYmFjaycgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nMTEwJyB5PSc0Nic+MTwvdGV4dD48bGluZSBzdHJva2U9JyMwMDAwMDAnIHN0cm9rZS13aWR0aD0nMScgeDE9JzE5MCcgeDI9Jzc1MCcgeTE9JzI1JyB5Mj0nMjUnLz48bGluZSBzdHJva2U9JyMwMDAwMDAnIHN0cm9rZS13aWR0aD0nMScgeDE9JzE5MCcgeDI9Jzc1MCcgeTE9JzY1JyB5Mj0nNjUnLz48bGluZSBzdHJva2U9JyMwMDAwMDAnIHN0cm9rZS13aWR0aD0nMScgeDE9JzE5MCcgeDI9JzE5MCcgeTE9JzI1JyB5Mj0nNjUnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nZW5kJyB4PSc3NDYnIHk9JzQ2Jz5OTUkgQ2F1c2U8L3RleHQ+PGxpbmUgc3Ryb2tlPScjMDAwMDAwJyBzdHJva2Utd2lkdGg9JzEnIHgxPSc3NTAnIHgyPScxMzEwJyB5MT0nMjUnIHkyPScyNScvPjxsaW5lIHN0cm9rZT0nIzAwMDAwMCcgc3Ryb2tlLXdpZHRoPScxJyB4MT0nNzUwJyB4Mj0nMTMxMCcgeTE9JzY1JyB5Mj0nNjUnLz48bGluZSBzdHJva2U9JyMwMDAwMDAnIHN0cm9rZS13aWR0aD0nMScgeDE9JzEzMTAnIHgyPScxMzEwJyB5MT0nMjUnIHkyPSc2NScvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtc2l6ZT0nMjQnIGZvbnQtd2VpZ2h0PSdib2xkJyB0ZXh0LWFuY2hvcj0nc3RhcnQnIHg9Jzc1NCcgeT0nNDYnPihXQVJMKTwvdGV4dD48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nTSsgMXAgRmFsbGJhY2snIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzExMCcgeT0nODYnPjE8L3RleHQ+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J00rIDFwIEZhbGxiYWNrJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc3NTAnIHk9Jzg2Jz5NWExFTi0xPC90ZXh0Pjwvc3ZnPg==" alt="Diagram" width="1340" height="106">
</div>
<div class="title">Figure 3. Resumable NMI cause <code>mncause</code>.</div>
</div>
<div class="paragraph">
<p>The <code>mncause</code> CSR holds the reason for the NMI, with bit MXLEN-1 set to
1, and the NMI cause encoded in the least-significant bits or zero if
NMI causes are not supported.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz48c3ZnIGhlaWdodD0nMTA2JyBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSd4TWlkWU1pZCBtZWV0JyB4bWxuczpzdmc9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB2ZXJzaW9uPScxLjAnIHZpZXdCb3g9JzAgMCAxMzQwIDEwNicgd2lkdGg9JzEzNDAnIHhtbG5zOnhsaW5rPSdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc1MCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nOTAnIHk9JzEzJz5NWExFTi0xPC90ZXh0Pjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PScxMzAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzE3MCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nMjEwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PScyNTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzI5MCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nMzMwJyB5PScxMyc+MTM8L3RleHQ+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzM3MCcgeT0nMTMnPjEyPC90ZXh0Pjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc0MTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzQ1MCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nNDkwJyB5PScxMyc+MTE8L3RleHQ+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzUzMCcgeT0nMTMnPjEwPC90ZXh0Pjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc1NzAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzYxMCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nNjUwJyB5PScxMyc+ODwvdGV4dD48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nNjkwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc3MzAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9Jzc3MCcgeT0nMTMnPjc8L3RleHQ+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzgxMCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nODUwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc4OTAnIHk9JzEzJy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzkzMCcgeT0nMTMnPjY8L3RleHQ+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9Jzk3MCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nMTAxMCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nMTA1MCcgeT0nMTMnPjQ8L3RleHQ+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J0NvdXJpZXIgTmV3LCBtb25vc3BhY2UnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzEwOTAnIHk9JzEzJz4zPC90ZXh0Pjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PScxMTMwJyB5PScxMycvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdDb3VyaWVyIE5ldywgbW9ub3NwYWNlJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PScxMTcwJyB5PScxMyc+MjwvdGV4dD48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nMTIxMCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nMTI1MCcgeT0nMTMnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nQ291cmllciBOZXcsIG1vbm9zcGFjZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nMTI5MCcgeT0nMTMnPjA8L3RleHQ+PGxpbmUgc3Ryb2tlPScjMDAwMDAwJyBzdHJva2Utd2lkdGg9JzEnIHgxPSczMCcgeDI9JzM1MCcgeTE9JzI1JyB5Mj0nMjUnLz48bGluZSBzdHJva2U9JyMwMDAwMDAnIHN0cm9rZS13aWR0aD0nMScgeDE9JzMwJyB4Mj0nMzUwJyB5MT0nNjUnIHkyPSc2NScvPjxsaW5lIHN0cm9rZT0nIzAwMDAwMCcgc3Ryb2tlLXdpZHRoPScxJyB4MT0nMzUwJyB4Mj0nMzUwJyB5MT0nMjUnIHkyPSc2NScvPjxsaW5lIHN0cm9rZT0nIzAwMDAwMCcgc3Ryb2tlLXdpZHRoPScxJyB4MT0nMzAnIHgyPSczMCcgeTE9JzI1JyB5Mj0nNjUnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LXNpemU9JzI0JyBmb250LXN0eWxlPSdpdGFsaWMnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzE5MCcgeT0nNDYnPlJlc2VydmVkPC90ZXh0PjxsaW5lIHN0cm9rZT0nIzAwMDAwMCcgc3Ryb2tlLXdpZHRoPScxJyB4MT0nMzUwJyB4Mj0nNDMwJyB5MT0nMjUnIHkyPScyNScvPjxsaW5lIHN0cm9rZT0nIzAwMDAwMCcgc3Ryb2tlLXdpZHRoPScxJyB4MT0nMzUwJyB4Mj0nNDMwJyB5MT0nNjUnIHkyPSc2NScvPjxsaW5lIHN0cm9rZT0nIzAwMDAwMCcgc3Ryb2tlLXdpZHRoPScxJyB4MT0nMzUwJyB4Mj0nMzUwJyB5MT0nMjUnIHkyPSc2NScvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdlbmQnIHg9JzQyNicgeT0nNDYnPk1OUFA8L3RleHQ+PGxpbmUgc3Ryb2tlPScjMDAwMDAwJyBzdHJva2Utd2lkdGg9JzEnIHgxPSc0MzAnIHgyPSc1MTAnIHkxPScyNScgeTI9JzI1Jy8+PGxpbmUgc3Ryb2tlPScjMDAwMDAwJyBzdHJva2Utd2lkdGg9JzEnIHgxPSc0MzAnIHgyPSc1MTAnIHkxPSc2NScgeTI9JzY1Jy8+PGxpbmUgc3Ryb2tlPScjMDAwMDAwJyBzdHJva2Utd2lkdGg9JzEnIHgxPSc1MTAnIHgyPSc1MTAnIHkxPScyNScgeTI9JzY1Jy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1zaXplPScyMCcgZm9udC13ZWlnaHQ9J2JvbGQnIHRleHQtYW5jaG9yPSdzdGFydCcgeD0nNDM0JyB5PSc0Nic+KFdBUkwpPC90ZXh0PjxsaW5lIHN0cm9rZT0nIzAwMDAwMCcgc3Ryb2tlLXdpZHRoPScxJyB4MT0nNTEwJyB4Mj0nNjcwJyB5MT0nMjUnIHkyPScyNScvPjxsaW5lIHN0cm9rZT0nIzAwMDAwMCcgc3Ryb2tlLXdpZHRoPScxJyB4MT0nNTEwJyB4Mj0nNjcwJyB5MT0nNjUnIHkyPSc2NScvPjxsaW5lIHN0cm9rZT0nIzAwMDAwMCcgc3Ryb2tlLXdpZHRoPScxJyB4MT0nNjcwJyB4Mj0nNjcwJyB5MT0nMjUnIHkyPSc2NScvPjxsaW5lIHN0cm9rZT0nIzAwMDAwMCcgc3Ryb2tlLXdpZHRoPScxJyB4MT0nNTEwJyB4Mj0nNTEwJyB5MT0nMjUnIHkyPSc2NScvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtc2l6ZT0nMjQnIGZvbnQtc3R5bGU9J2l0YWxpYycgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nNTkwJyB5PSc0Nic+UmVzZXJ2ZWQ8L3RleHQ+PGxpbmUgc3Ryb2tlPScjMDAwMDAwJyBzdHJva2Utd2lkdGg9JzEnIHgxPSc2NzAnIHgyPSc3OTAnIHkxPScyNScgeTI9JzI1Jy8+PGxpbmUgc3Ryb2tlPScjMDAwMDAwJyBzdHJva2Utd2lkdGg9JzEnIHgxPSc2NzAnIHgyPSc3OTAnIHkxPSc2NScgeTI9JzY1Jy8+PGxpbmUgc3Ryb2tlPScjMDAwMDAwJyBzdHJva2Utd2lkdGg9JzEnIHgxPSc2NzAnIHgyPSc2NzAnIHkxPScyNScgeTI9JzY1Jy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J2VuZCcgeD0nNzg2JyB5PSc0Nic+TU5QVjwvdGV4dD48bGluZSBzdHJva2U9JyMwMDAwMDAnIHN0cm9rZS13aWR0aD0nMScgeDE9Jzc5MCcgeDI9JzkxMCcgeTE9JzI1JyB5Mj0nMjUnLz48bGluZSBzdHJva2U9JyMwMDAwMDAnIHN0cm9rZS13aWR0aD0nMScgeDE9Jzc5MCcgeDI9JzkxMCcgeTE9JzY1JyB5Mj0nNjUnLz48bGluZSBzdHJva2U9JyMwMDAwMDAnIHN0cm9rZS13aWR0aD0nMScgeDE9JzkxMCcgeDI9JzkxMCcgeTE9JzI1JyB5Mj0nNjUnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LXNpemU9JzI0JyBmb250LXdlaWdodD0nYm9sZCcgdGV4dC1hbmNob3I9J3N0YXJ0JyB4PSc3OTQnIHk9JzQ2Jz4oV0FSTCk8L3RleHQ+PGxpbmUgc3Ryb2tlPScjMDAwMDAwJyBzdHJva2Utd2lkdGg9JzEnIHgxPSc5MTAnIHgyPScxMDcwJyB5MT0nMjUnIHkyPScyNScvPjxsaW5lIHN0cm9rZT0nIzAwMDAwMCcgc3Ryb2tlLXdpZHRoPScxJyB4MT0nOTEwJyB4Mj0nMTA3MCcgeTE9JzY1JyB5Mj0nNjUnLz48bGluZSBzdHJva2U9JyMwMDAwMDAnIHN0cm9rZS13aWR0aD0nMScgeDE9JzEwNzAnIHgyPScxMDcwJyB5MT0nMjUnIHkyPSc2NScvPjxsaW5lIHN0cm9rZT0nIzAwMDAwMCcgc3Ryb2tlLXdpZHRoPScxJyB4MT0nOTEwJyB4Mj0nOTEwJyB5MT0nMjUnIHkyPSc2NScvPjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtc2l6ZT0nMjQnIGZvbnQtc3R5bGU9J2l0YWxpYycgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nOTkwJyB5PSc0Nic+UmVzZXJ2ZWQ8L3RleHQ+PGxpbmUgc3Ryb2tlPScjMDAwMDAwJyBzdHJva2Utd2lkdGg9JzEnIHgxPScxMDcwJyB4Mj0nMTE1MCcgeTE9JzI1JyB5Mj0nMjUnLz48bGluZSBzdHJva2U9JyMwMDAwMDAnIHN0cm9rZS13aWR0aD0nMScgeDE9JzEwNzAnIHgyPScxMTUwJyB5MT0nNjUnIHkyPSc2NScvPjxsaW5lIHN0cm9rZT0nIzAwMDAwMCcgc3Ryb2tlLXdpZHRoPScxJyB4MT0nMTE1MCcgeDI9JzExNTAnIHkxPScyNScgeTI9JzY1Jy8+PGxpbmUgc3Ryb2tlPScjMDAwMDAwJyBzdHJva2Utd2lkdGg9JzEnIHgxPScxMDcwJyB4Mj0nMTA3MCcgeTE9JzI1JyB5Mj0nNjUnLz48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nTSsgMXAgRmFsbGJhY2snIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzExMTAnIHk9JzQ2Jz5OTUlFPC90ZXh0PjxsaW5lIHN0cm9rZT0nIzAwMDAwMCcgc3Ryb2tlLXdpZHRoPScxJyB4MT0nMTE1MCcgeDI9JzEzMTAnIHkxPScyNScgeTI9JzI1Jy8+PGxpbmUgc3Ryb2tlPScjMDAwMDAwJyBzdHJva2Utd2lkdGg9JzEnIHgxPScxMTUwJyB4Mj0nMTMxMCcgeTE9JzY1JyB5Mj0nNjUnLz48bGluZSBzdHJva2U9JyMwMDAwMDAnIHN0cm9rZS13aWR0aD0nMScgeDE9JzEzMTAnIHgyPScxMzEwJyB5MT0nMjUnIHkyPSc2NScvPjxsaW5lIHN0cm9rZT0nIzAwMDAwMCcgc3Ryb2tlLXdpZHRoPScxJyB4MT0nMTE1MCcgeDI9JzExNTAnIHkxPScyNScgeTI9JzY1Jy8+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1zaXplPScyNCcgZm9udC1zdHlsZT0naXRhbGljJyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PScxMjMwJyB5PSc0Nic+UmVzZXJ2ZWQ8L3RleHQ+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J00rIDFwIEZhbGxiYWNrJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PScxOTAnIHk9Jzg2Jz5NWExFTi0xMzwvdGV4dD48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nTSsgMXAgRmFsbGJhY2snIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzQzMCcgeT0nODYnPjI8L3RleHQ+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J00rIDFwIEZhbGxiYWNrJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PSc1OTAnIHk9Jzg2Jz4zPC90ZXh0Pjx0ZXh0IGRvbWluYW50LWJhc2VsaW5lPSdtaWRkbGUnIGZvbnQtZmFtaWx5PSdNKyAxcCBGYWxsYmFjaycgZm9udC1zaXplPScyNCcgdGV4dC1hbmNob3I9J21pZGRsZScgeD0nNzkwJyB5PSc4Nic+MTwvdGV4dD48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nTSsgMXAgRmFsbGJhY2snIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9Jzk5MCcgeT0nODYnPjM8L3RleHQ+PHRleHQgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZScgZm9udC1mYW1pbHk9J00rIDFwIEZhbGxiYWNrJyBmb250LXNpemU9JzI0JyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyB4PScxMTEwJyB5PSc4Nic+MTwvdGV4dD48dGV4dCBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJyBmb250LWZhbWlseT0nTSsgMXAgRmFsbGJhY2snIGZvbnQtc2l6ZT0nMjQnIHRleHQtYW5jaG9yPSdtaWRkbGUnIHg9JzEyMzAnIHk9Jzg2Jz4zPC90ZXh0Pjwvc3ZnPg==" alt="Diagram" width="1340" height="106">
</div>
<div class="title">Figure 4. Resumable NMI status register <code>mnstatus</code>.</div>
</div>
<div class="paragraph">
<p>The <code>mnstatus</code> CSR holds a two-bit field, MNPP, which on entry to the
trap handler holds the privilege mode of the interrupted context,
encoded in the same manner as <code>mstatus</code>.MPP. It also holds a one-bit
field, MNPV, which on entry to the trap handler holds the virtualization
mode of the interrupted context, encoded in the same manner as
<code>mstatus</code>.MPV.</p>
</div>
<div class="paragraph">
<p><code>mnstatus</code> also holds the NMIE bit. When NMIE=1, nonmaskable interrupts
are enabled. When NMIE=0, <em>all</em> interrupts are disabled.</p>
</div>
<div class="paragraph">
<p>When NMIE=0, the hart behaves as though <code>mstatus</code>.MPRV were clear,
regardless of the current setting of <code>mstatus</code>.MPRV.</p>
</div>
<div class="paragraph">
<p>Upon reset, NMIE contains the value 0.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>RNMIs are masked out of reset to give software the opportunity to
initialize data structures and devices for subsequent RNMI handling.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Software can set NMIE to 1, but attempts to clear NMIE have no effect.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Normally, only reset sequences will explicitly set the NMIE bit.</p>
</div>
<hr>
<div class="paragraph">
<p>That the NMIE bit is settable does not suffice to support the nesting of
RNMIs. To support this feature in a direct manner would have required
allowing software to clear the NMIE bit—a design choice that would have
contravened the concept of non-maskability.</p>
</div>
<div class="paragraph">
<p>Software that wishes to minimize the latency until the next RNMI is
taken can follow the top-half/bottom-half model, where the RNMI handler
itself only enqueues a task to a task queue then returns. The bulk of
the interrupt servicing is performed later, with RNMIs enabled.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For the purposes of the WFI instruction, NMIE is a global interrupt
enable, meaning that the setting of NMIE does not affect the operation
of the WFI instruction.</p>
</div>
<div class="paragraph">
<p>The other bits in <code>mnstatus</code> are <em>reserved</em>; software should write zeros
and hardware implementations should return zeros.</p>
</div>
</div>
<div class="sect2">
<h3 id="_mnret_instruction">1.4. MNRET Instruction</h3>
<div class="paragraph">
<p>MNRET is an M-mode-only instruction that uses the values in <code>mnepc</code> and
<code>mnstatus</code> to return to the program counter, privilege mode, and
virtualization mode of the interrupted context. This instruction also
sets <code>mnstatus</code>.NMIE.  If MNRET changes the privilege mode to a mode less privileged than M, it also sets <code>mstatus</code>.MPRV to 0.</p>
</div>
</div>
<div class="sect2">
<h3 id="_rnmi_operation">1.5. RNMI Operation</h3>
<div class="paragraph">
<p>When an RNMI interrupt is detected, the interrupted PC is written to the
<code>mnepc</code> CSR, the type of RNMI to the <code>mncause</code> CSR, and the privilege
mode of the interrupted context to the <code>mnstatus</code> CSR. The
<code>mnstatus</code>.NMIE bit is cleared, masking all interrupts.</p>
</div>
<div class="paragraph">
<p>The hart then enters machine-mode and jumps to the RNMI trap handler
address.</p>
</div>
<div class="paragraph">
<p>The RNMI handler can resume original execution using the new MNRET
instruction, which restores the PC from <code>mnepc</code>, the privilege mode from
<code>mnstatus</code>, and also sets <code>mnstatus</code>.NMIE, which re-enables interrupts.</p>
</div>
<div class="paragraph">
<p>If the hart encounters an exception while executing in M-mode with the <code>mnstatus</code>.NMIE bit clear, the actions taken are the same as if the exception had occurred while <code>mnstatus</code>.NMIE were set, except that the program counter is set to the RNMI exception trap handler address (rather than the address specified by <code>mtvec</code>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Smrnmi extension does not change the behavior of the MRET and SRET
instructions. In particular, MRET and SRET are unaffected by the
<code>mnstatus</code>.NMIE bit, and their execution does not alter the
<code>mnstatus</code>.NMIE bit.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>

</body>
</html>