<html>
<head>
<title>RISC-V External Debug Support</title>
</head>
<body>

<table>
<tr><th colspan=2>Metadata Table</th></tr>
<tr><th>Manual Type</th><td> debug</td></tr>
<tr><th>Spec Revision</th><td> 0.13.2</td></tr>
<tr><th>Spec Release Date</th><td> 2019-03-25</td></tr>
<tr><th>Git Revision</th><td> task_group_vote-4-g4e0bb0f</td></tr>
<tr><th>Git URL</th><td><a href=https://github.com/riscv/riscv-debug-spec.git>https://github.com/riscv/riscv-debug-spec.git</a></td></tr>
<tr><th>Source</th><td>jtagdtm.tex</td></tr>
<tr><th>Conversion Date</th><td>2023/10/11</td></tr>
<tr><th>License</th><td><a href=https://creativecommons.org/licenses/by/4.0/>CC-by-4.0</a></td></tr>
</table>


<h1 id="sec:jtagdtm"><span class="header-section-number">8</span> JTAG Debug Transport Module</h1>
<p>This Debug Transport Module is based around a normal JTAG Test Access Port
(TAP). The JTAG TAP allows access to arbitrary JTAG registers by first
selecting one using the JTAG instruction register (IR), and then accessing it
through the JTAG data register (DR).</p>
<h2 id="jtag-background"><span class="header-section-number">8.1</span> JTAG Background</h2>
<p>JTAG refers to IEEE Std 1149.1-2013. It is a standard that defines test logic
that can be included in an integrated circuit to test the interconnections
between integrated circuits, test the integrated circuit itself, and observe or
modify circuit activity during the component’s normal operation.
This specification uses the latter functionality.
The JTAG standard defines a Test Access Port (TAP) that
can be used to read and write a few custom registers, which can be used to
communicate with debug hardware in a component.</p>
<h2 id="jtag-dtm-registers"><span class="header-section-number">8.2</span> JTAG DTM Registers</h2>
<p>JTAG TAPs used as a DTM must have an IR of at least 5 bits.
When the TAP is reset, IR must default to
00001, selecting the IDCODE instruction. A full list of JTAG registers along
with their encoding is in Table <a href="jtag_registers.html#table:jtag_registers" data-reference-type="ref" data-reference="table:jtag_registers">[table:jtag_registers]</a>.
If the IR actually has more than 5 bits, then the encodings in
Table <a href="jtag_registers.html#table:jtag_registers" data-reference-type="ref" data-reference="table:jtag_registers">[table:jtag_registers]</a> should be extended with 0’s in their
most significant bits.
The only regular JTAG registers a debugger might use are BYPASS and IDCODE, but this
specification leaves IR space for many other standard JTAG instructions.
Unimplemented instructions must select the BYPASS register.</p>
<p><a href="jtag_registers.html" data-reference-type="ref" data-reference="jtag_registers.tex">[jtag_registers.tex]</a></p>
<h2 id="recommended-jtag-connector"><span class="header-section-number">8.3</span> Recommended JTAG Connector</h2>
<p>To make it easy to acquire debug hardware, this spec recommends a connector
that is compatible with the MIPI-10 .05 inch connector specification, as described
in the MIPI Alliance Recommendation for Debug and Trace Connectors, Version
1.10.00, 16 March 2011.</p>
<p>The connector has .05 inch spacing, gold-plated male header with .016 inch thick
hardened copper or beryllium bronze square posts (SAMTEC FTSH or equivalent).
Female connectors are compatible <span class="math inline">20<em>μ</em><em>m</em></span> gold connectors.</p>
<p>Viewing the male header from above (the pins pointing at your eye), a target’s
connector looks as it does in Table <a href="jtagdtm.html#tab:mipiten" data-reference-type="ref" data-reference="tab:mipiten">[tab:mipiten]</a>. The function of each pin
is described in Table <a href="jtagdtm.html#tab:pinout" data-reference-type="ref" data-reference="tab:pinout">1</a>.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">VREF DEBUG</th>
<th style="text-align: center;">1</th>
<th style="text-align: center;">2</th>
<th style="text-align: left;">TMS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">GND</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">4</td>
<td style="text-align: left;">TCK</td>
</tr>
<tr class="even">
<td style="text-align: right;">GND</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">6</td>
<td style="text-align: left;">TDO</td>
</tr>
<tr class="odd">
<td style="text-align: right;">GND or KEY</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">8</td>
<td style="text-align: left;">TDI</td>
</tr>
<tr class="even">
<td style="text-align: right;">GND</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">10</td>
<td style="text-align: left;">nRESET</td>
</tr>
</tbody>
</table>
<p>If a platform requires nTRST then it is permissible to reuse the nRESET pin as
the nTRST signal. If a platform requires both system reset and TAP reset, the
MIPI-20 connector should be used. Its physical connector is virtually identical
to MIPI-10, except that it’s twice as long, supporting twice as many pins. Its
connector is show in Table <a href="jtagdtm.html#tab:mipitwenty" data-reference-type="ref" data-reference="tab:mipitwenty">[tab:mipitwenty]</a>.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">VREF DEBUG</th>
<th style="text-align: center;">1</th>
<th style="text-align: center;">2</th>
<th style="text-align: left;">TMS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">GND</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">4</td>
<td style="text-align: left;">TCK</td>
</tr>
<tr class="even">
<td style="text-align: right;">GND</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">6</td>
<td style="text-align: left;">TDO</td>
</tr>
<tr class="odd">
<td style="text-align: right;">GND or KEY</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">8</td>
<td style="text-align: left;">TDI</td>
</tr>
<tr class="even">
<td style="text-align: right;">GND</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">10</td>
<td style="text-align: left;">nRESET</td>
</tr>
<tr class="odd">
<td style="text-align: right;">GND</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">12</td>
<td style="text-align: left;">RTCK</td>
</tr>
<tr class="even">
<td style="text-align: right;">GND</td>
<td style="text-align: center;">13</td>
<td style="text-align: center;">14</td>
<td style="text-align: left;">nTRST_PD</td>
</tr>
<tr class="odd">
<td style="text-align: right;">GND</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">16</td>
<td style="text-align: left;">nTRST</td>
</tr>
<tr class="even">
<td style="text-align: right;">GND</td>
<td style="text-align: center;">17</td>
<td style="text-align: center;">18</td>
<td style="text-align: left;">DBGRQ</td>
</tr>
<tr class="odd">
<td style="text-align: right;">GND</td>
<td style="text-align: center;">19</td>
<td style="text-align: center;">20</td>
<td style="text-align: left;">DBGACK</td>
</tr>
</tbody>
</table>
<figure>
<img src="jtagdtm_00.svg" alt="JTAG Connector Pinout" id="tab:pinout" /><figcaption>JTAG Connector Pinout<span label="tab:pinout"></span></figcaption>
</figure>
<p>The same connectors can be used for 2-wire cJTAG. In that case TMS is used for
TMSC, and TCK is used for TCKC.</p>

</body>
</html>
